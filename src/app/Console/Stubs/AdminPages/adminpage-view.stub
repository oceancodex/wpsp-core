<?php

namespace {{ rootNamespace }}\App\WordPress\AdminPages;

use Illuminate\Http\Request;
use {{ rootNamespace }}\App\WordPress\License\License;
use {{ rootNamespace }}\App\Instances\Auth\Auth;
use {{ rootNamespace }}\App\Instances\Cache\Cache;
use {{ rootNamespace }}\App\Jobs\SendEmailJob;
use {{ rootNamespace }}\App\Jobs\TestJob;
use {{ rootNamespace }}\App\Instances\Database\Migration;
use {{ rootNamespace }}\App\Models\SettingsModel;
use {{ rootNamespace }}\App\Models\UsersModel;
use {{ rootNamespace }}\App\Traits\InstancesTrait;
use {{ rootNamespace }}\App\View\Share;
use {{ rootNamespace }}\Funcs;
use {{ coreNamespace }}\Base\BaseAdminPage;

class {{ className }} extends BaseAdminPage {

	use InstancesTrait;

	/**
	 * WordPress admin page properties.
	 */
	public $menu_title                  = '{{ name }}';
//	public $page_title                  = '{{ name }}';                 // Thẻ <title> trong HTML.
//	public $first_submenu_title         = 'Dashboard';                  // Khi có nhiều submenu, WordPress sẽ tự sinh submenu cho trang chính. Thay đổi tên submenu tự sinh.
	public $capability                  = 'manage_options';
//	public $menu_slug                   = '{{ path_slugify }}';
	public $icon_url                    = 'dashicons-admin-generic';
//	public $position                    = 2;
//	public $parent_slug                 = 'options-general.php';
//	public $is_submenu_page             = false;
//	public $remove_first_submenu        = false;
//	public $urls_highlight_current_menu = null;
//	public $callback_function           = null;

	/**
	 * Parent properties.
	 */
//	protected $screen_options           = null;
//	protected $screen_options_key       = null;

	/**
	 * Custom properties.
	 */
	private $currentTab                 = null;
	private $currentPage                = null;

	/*
	 *
	 */

	public function customProperties() {
//		$this->menu_title                  = '';
//		$this->page_title                  = '';
//		$this->capability                  = '';
//		$this->menu_slug                   = '';
//		$this->icon_url                    = '';
//		$this->position                    = '';
//		$this->parent_slug                 = '';
//		$this->is_submenu_page             = true;
//	    $this->remove_first_submenu        = false;
//		$this->urls_highlight_current_menu = [];
//      $this->callback_function           = null;

//      $this->$screen_options             = null;
//      $this->$screen_options_key         = null;

		$this->currentTab  = $this->request->get('tab');
		$this->currentPage = $this->request->get('page');

		$this->page_title = ($this->currentTab ? Funcs::trans('messages.' . $this->currentTab) : Funcs::trans('messages.{{ name }}')) . ' - ' . Funcs::config('app.name');

//		$this->screen_options_key = $this->funcs->_slugParams(['page', 'tab']);
//		if (in_array($this->currentTab, ['table', 'roles', 'permissions', 'users'])) {
//			$this->screen_options = true;
//		}
	}

	/*
	 *
	 */

//	public function init($path = null) {
//		// You must call to parent method "init" if you want to custom it.
//		parent::init();
//
//      // Your code here...
//	}

	public function beforeInit() {}

	public function afterInit() {
		// Custom highlight current menu.
//		if (preg_match('/' . $this->menu_slug . '$|' . $this->menu_slug . '&updated=true$/', $this->request->getRequestUri())) {
//			add_filter('submenu_file', function($submenu_file) {
//				return $this->menu_slug;
//			});
//		}
	}

	public function afterLoad($adminPage) {}

//	public function screenOptions($adminPage) {
//		if ($this->currentTab == 'table') {
//			parent::screenOptions($adminPage);
//		}
//	}

	/*
	 *
	 */

	public function index(Request $request) {
		$requestParams = $request->all();
		$menuSlug      = $this->getMenuSlug();
        echo Funcs::view('modules.admin-pages.{{ path }}.main', compact('requestParams', 'menuSlug'));
	}

	public function update() {}

	/*
	 *
	 */

	public function styles() {
		wp_enqueue_style(
			Funcs::config('app.short_name') . '-bootstrap-grid',
			Funcs::instance()->_getPublicUrl() . '/extras/plugins/bootstrap/css/bootstrap-grid.min.css',
			null,
			Funcs::instance()->_getVersion()
		);
		wp_enqueue_style(
			Funcs::config('app.short_name') . '-bootstrap-utilities',
			Funcs::instance()->_getPublicUrl() . '/extras/plugins/bootstrap/css/bootstrap-utilities.min.css',
			null,
			Funcs::instance()->_getVersion()
		);
	}

	public function scripts() {
//		wp_enqueue_script();
	}

	public function localizeScripts() {
//		wp_localize_script();
	}

}